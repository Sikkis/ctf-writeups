# PentestCyprus 3.0 | f0rest

**Category:** Miscellaneous **Difficulty:** Medium

**Description:** Eliot found this code left for him form Mr.Robot. We need to discover what it means.
Hint: Huffman was lost in a forest full of trees. Some of them were binary.

## Files provided:
![f0rest](https://github.com/Sikkis/ctf-writeups/blob/master/2017/pentestcyprus3.0/Miscellaneous/f0rest/images/f0rest.svg)

Code:`0101101101111101011110101100111001010000100011110100101000011111111011011111100111001111110001000110010001110111101011011111011011111111011101000010001110011100111111011101000010110010001110010001100111001111101001111100011110101100111001111101111111100111101000011100111111010111101001111101100100010100111000`

By inspecting the image we can realize that this is an index tree based on the frequency of each hexadecimal characters. We can get the binary interpretation of each character by tracing each value from the top of the tree to the leaves, adding a 0 when you go left and a 1 when you go right. So for example the character **E** will be: left,left,left which is equals to `E = 000`. We can build a table with this values and decode the secret message!

## Solution
```python
from bitarray import bitarray

huffman_dict = {
    'E': bitarray('000'), '0': bitarray('001'), '7':bitarray('01000'), 
    'F': bitarray('01001'),'D': bitarray('01010'),'5': bitarray('010110'),
    'B': bitarray('010111'), '1': bitarray('0110'), '2': bitarray('0111'),
    '9': bitarray('100'), '8': bitarray('1010'),'C': bitarray('10110'),
    'A': bitarray('10111'),'4': bitarray('110'),'3': bitarray('1110'),
    '6': bitarray('1111')

}

dec = bitarray('0101101101111101011110101100111001010000100011110100101000011111111011011111100111001111110001000110010001110111101011011111011011111111011101000010001110011100111111011101000010110010001110010001100111001111101001111100011110101100111001111101111111100111101000011100111111010111101001111101100100010100111000').decode(huffman_dict)
print(dec)
print(''.join(dec)).decode("hex")

```
We then connect with netcat to the remote host and submit the secret message we got. The Flag will pop right up! ;)

```bash
$ root@kali:~/# nc challenges.pentestcyprus.org 7000
Enter the decoded message: The world itself\'s just one big hoax.
pency_3{such_4_hug3_t4sk_with_trees}
```