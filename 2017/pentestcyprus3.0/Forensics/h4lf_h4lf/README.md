# PentestCyprus 3.0 | h4lf_h4lf

**Category:** Forensics **Difficulty:** Easy

**Description:** E-Corp is trying to obfuscated their communications but we know there is something valuable in there.

https://s3.eu-central-1.amazonaws.com/pentestcyprus/forensics-1/h4lf_h4lf.pcap

## Solution
The competition had a pre defined structure for the flags. If we check the rules section in the website we can see that the format is pency_3{s0mething_s0mething}. When we open the pcap file we Wireshark we can search the packets contain for this pattern with the following wireshark filter:
```
data contains "pency"
```
![Data Contains](https://github.com/Sikkis/ctf-writeups/blob/master/2017/pentestcyprus3.0/Forensics/h4lf_h4lf/images/tcp-data-first-half.png)

As the name of the challenges implies the message in two half's! We have to find the other half. The next step is to follow the tcp stream to see if the second part of the flag but it was a dead end.

![Tcp Stream](https://github.com/Sikkis/ctf-writeups/blob/master/2017/pentestcyprus3.0/Forensics/cl3ar_keys/images/tcp-stream-6.png)

I tried to follow then other tcp streams before and after the 6th one but i did not have any luck... And then it hit me! I could just search for the end bracket! Using the same method as before the second half of the flag is found in a UDP package!

```
data contains "}"
```
![Udp Stream](https://github.com/Sikkis/ctf-writeups/blob/master/2017/pentestcyprus3.0/Forensics/cl3ar_keys/images/udp-stream-second-half.png)